<!DOCTYPE html>
<html>
<head>
    <title>祝哈基杰二十岁生日快乐</title>
    <style>
        .popup {
            position: absolute;
            padding: 20px;
            background: linear-gradient(135deg, #6e8efb, #a777e3);
            border: 3px solid #fff;
            border-radius: 15px;
            font-family: "华文新魏", sans-serif;
            font-size: 32px;
            font-weight: bold;
            text-align: center;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            animation: fadeInScale 0.5s ease-out, float 3s ease-in-out infinite;
            backdrop-filter: blur(5px);
            transition: transform 0.3s ease;
            
        }
        
        .popup:hover {
            transform: scale(1.1);
        }
        
        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        /* 添加音乐控制按钮样式 */
        .music-control {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.8);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        /* 添加播放提示样式 */
        .play-prompt {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: white;
            font-size: 24px;
            z-index: 2000;
            cursor: pointer;
        }
        
        .play-button {
            margin-top: 20px;
            padding: 15px 30px;
            background: #6e8efb;
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- 添加播放提示界面 -->
    <div class="play-prompt" id="playPrompt">
        <div>点击下方按钮开始</div>
        <button class="play-button" onclick="startAll()">开始</button>
        <div id="loadingText" style="margin-top: 20px; font-size: 16px;"></div>
    </div>
    
    <!-- 添加音频元素和控制按钮 -->
    <audio id="background-music" loop preload="auto">
        <source src="./audio/周深 - 小美满.mp3" type="audio/mpeg">
    </audio>
    <button class="music-control" onclick="toggleMusic()" id="musicControl" style="display:none;">⏸️</button>
    
    <script>
        // 生日祝福（带前缀）
        const birthdayWishes = [
            "生日快乐！", "天天开心！", "永远不死！", 
            "远离伤病！", "努力赚钱给哈基明花", "生日快乐！！！！！"
        ].map(wish => `祝哈基杰：${wish}`);
        // 梅西名言（无前缀）
        const messiQuotes = [
            "我每天都在想自己有多幸运，能做自己喜欢的事。",
            "成功是努力的副产品，如果你专注于做好工作，成功就会来。",
            "我不认为自己是巨星，我只是一个喜欢踢足球的人。",
            "在球场上，重要的不是你有多强，而是你有多渴望胜利。",
            "团队合作永远比个人英雄主义更重要，足球是11个人的运动。",
            "我每天都在学习，即使现在，我仍觉得自己有很多要改进的地方。"
        ];
        const allContents = [...birthdayWishes, ...messiQuotes];

        // 生成弹窗
        function createPopup() {
            const popup = document.createElement("div");
            popup.className = "popup";
            popup.textContent = allContents[Math.floor(Math.random() * allContents.length)];
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;
            const left = Math.random() * (screenWidth - 350);
            const top = Math.random() * (screenHeight - 150);
            popup.style.left = left + "px";
            popup.style.top = top + "px";
            document.body.appendChild(popup);
        }

        // 批量生成变量
        let count = 0;
        let interval;

        // 开始所有功能的函数
        function startAll() {
            const playPrompt = document.getElementById('playPrompt');
            const musicButton = document.getElementById('musicControl');
            const loadingText = document.getElementById('loadingText');
            
            // 显示加载提示
            loadingText.textContent = "加载中，请稍候...";
            
            // 尝试播放音乐
            const music = document.getElementById('background-music');
            const playPromise = music.play();
            
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    // 音乐播放成功
                    loadingText.textContent = "";
                    playPrompt.style.display = 'none';
                    musicButton.style.display = 'block';
                    
                    // 音乐加载完成后开始生成弹窗
                    startPopups();
                }).catch(error => {
                    // 音乐播放失败或需要用户交互
                    console.log("播放失败:", error);
                    loadingText.textContent = "加载失败，无法开始";
                    // 音乐加载失败时不生成弹窗
                });
            }
        }
        
        // 开始生成弹窗的函数
        function startPopups() {
            interval = setInterval(() => {
                createPopup();
                count++;
                if (count >= 150) clearInterval(interval);
            }, 1500);
        }
        
        // 音乐控制功能
        const music = document.getElementById('background-music');
        const musicButton = document.getElementById('musicControl');
        let isPlaying = true;
        
        // 切换音乐播放/暂停
        function toggleMusic() {
            if (isPlaying) {
                music.pause();
                musicButton.textContent = '▶️';
                isPlaying = false;
            } else {
                music.play().catch(e => console.log("播放失败:", e));
                musicButton.textContent = '⏸️';
                isPlaying = true;
            }
        }
    </script>
</body>
</html>